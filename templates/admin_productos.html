<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Gesti√≥n de Productos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='style/styleAdmin_Productos.css') }}?v=1">
    <link rel="stylesheet" href="{{ url_for('static', filename='style/styleGeneral.css') }}?v=1">
</head>
<body class="d-flex flex-column min-vh-100 bg-light">

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark px-4">
    <!-- Logo -->
    <img src="{{ url_for('static', filename='images/logoSfer_ProductManager_blanco.png') }}" alt="Logo" width="50" height="50" class="mb-1">
    <a class="navbar-brand me-3" href="{{ url_for('admin_productos') }}"> PRODUCTOS </a>

    <!-- Bot√≥n hamburguesa -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
    </button>

    <!-- Men√∫ colapsable -->
    <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
            <!-- Productos al lado del dashboard -->
            <li class="nav-item">
                <a class="nav-link" href="{{ url_for('dashboard_admin') }}">Dashboard Administrador</a>
            </li>
        </ul>
        <ul class="navbar-nav ms-auto">
            <!-- Cerrar sesi√≥n alineado a la derecha -->
            <li class="nav-item">
                <a class="nav-link text-danger" href="{{ url_for('logout') }}">Cerrar sesi√≥n</a>
            </li>
        </ul>
    </div>
</nav>

<div class="container" style="max-width: 1600px;">
    <h3 class="mb-4 text-center">Gesti√≥n de Productos</h3>

    <!-- FORMULARIO -->
    <div class="card shadow-sm p-4 mb-4">
        <h5 class="card-title mb-3">‚ûï A√±adir nuevo producto</h5>
        <form action="{{ url_for('agregar_producto') }}" method="POST" enctype="multipart/form-data" class="row g-3">
            <div class="col-md-4">
                <input type="text" name="nombre" class="form-control" placeholder="Nombre" required>
            </div>
            <div class="col-md-4">
                <input type="text" name="descripcion" class="form-control" placeholder="Descripci√≥n" required>
            </div>
            <div class="col-md-2">
                <input type="number" name="stock" class="form-control" placeholder="Stock" required>
            </div>
            <div class="col-md-2">
                <input type="number" step="0.01" name="precio" class="form-control" placeholder="Precio" required>
            </div>
            <div class="col-md-4">
                <input type="text" name="ubicacion" class="form-control" placeholder="Ubicaci√≥n" required>
            </div>
            <div class="col-md-4">
                <input type="text" name="color" class="form-control" placeholder="Color" required>
            </div>
            <!-- Selector de proveedor -->
            <div class="col-md-4">
                <select name="id_proveedor" class="form-select" required>
                    <option disabled selected value="">Selecciona un proveedor</option>
                    {% for proveedor in proveedores %}
                        <option value="{{ proveedor.id_proveedor }}">{{ proveedor.nombre_empresa }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-4">
                <input type="file" name="imagen" class="form-control" accept="image/*" required>
            </div>
            <div class="col-md-2">
                <button type="submit" class="btn btn-success w-100">A√±adir</button>
            </div>
        </form>
    </div>

    <!-- TABLA -->
    <div class="table-responsive">
        <table class="table table-sm table-striped table-bordered align-middle text-center shadow-sm">
            <thead class="table-dark">
                <tr>
                    <th>Nombre</th>
                    <th>Descripci√≥n</th>
                    <th>Stock</th>
                    <th>Precio (‚Ç¨)</th>
                    <th>Ubicaci√≥n</th>
                    <th>Color</th>
                    <th>Imagen</th>
                    <th colspan="2"></th>
                </tr>
            </thead>
            <tbody>
                {% for producto in productos %}
                <tr>
                    <td class="fw-bold">{{ producto.nombre }}</td>
                    <td>{{ producto.descripcion }}</td>
                    <td>{{ producto.cantidad_en_stock }}</td>
                    <td>{{ '%.2f'|format(producto.precio) }}</td>
                    <td>{{ producto.ubicacion }}</td>
                    <td>{{ producto.color }}</td>
                    <td>
                        <img src="{{ url_for('static', filename='images/' + producto.imagen) }}"
                             alt="{{ producto.nombre }}"
                             style="width: 50px; height: 50px; object-fit: cover;">
                    </td>
                    <td>
                        <a href="{{ url_for('editar_producto', id_producto=producto.id_producto) }}"
                           class="btn btn-warning btn-sm w-100">‚úèÔ∏è Editar</a>
                    </td>
                    <td>
                        <a href="{{ url_for('eliminar_producto', id_producto=producto.id_producto) }}"
                           class="btn btn-danger btn-sm w-100">üóëÔ∏è Eliminar</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- FOOTER -->
<footer class="bg-dark text-white mt-auto pt-4">
    <div class="container">
        <div class="row justify-content-between align-items-center">
            <div class="col-md-6 mb-3 mb-md-0">
                <h6 class="fw-bold text-uppercase">SFER & PRODUCTMANAGER</h6>
                <p class="mb-0">Plataforma premium para la gesti√≥n inteligente de productos y proveedores.</p>
            </div>
            <div class="col-md-6 text-md-end">
                <p class="mb-1">Contacto: <a href="mailto:sferproductmanager@gmail.com" class="text-white">sferproductmanager@gmail.com</a></p>
                <a href="https://www.linkedin.com/in/sergio-fern√°ndez-l√≥pez-8784bb270" class="text-white me-3 text-decoration-none" target="_blank"><i class="bi bi-linkedin"></i> LinkedIn</a>
                <a href="https://www.instagram.com/sfer_productmanager?igsh=MWp5aWZ3bGhtcmx0Zw%3D%3D" class="text-white text-decoration-none" target="_blank"><i class="bi bi-instagram"></i> Instagram</a>
            </div>
        </div>
        <hr class="bg-light my-3">
        <div class="text-center text-secondary small pb-3">
            ¬© {{ current_year if current_year else 2025 }} Sfer & ProductManager ¬∑ Todos los derechos reservados
        </div>
    </div>
</footer>

</body>
</html>